function [L,n,t]=refraction_index(varargin)
% Return the refraction index as a function of wavelength
% Package: telescope.Optics
% Description: Return the refraction index as a function of wavelength
%              for various materials.
% Input  : - 
%          * Arbitrary number of pairs of arguments: ...,keyword,value,...
%            where keyword are one of the followings:
%            'T' - Temperature [C]. Default is 20.
%            'Material' - Options are:
%                         'SiO2' (fused silica) default.
% Output : - Wavelength [Ang].
%          - Refraction index
%          - [Wave[Ang], Transmission per 1cm thickness]
% License: GNU general public license version 3
%     By : Eran O. Ofek                    Oct 2019
%    URL : http://weizmann.ac.il/home/eofek/matlab/
% Example: [L,n,t]=telescope.Optics.refraction_index('Material','SiO2')
% Reliable: 
%--------------------------------------------------------------------------



DefV.T                    = 20;
DefV.Material             = 'si02_suprasil_2a';  % 'SiO2';
InPar = InArg.populate_keyval(DefV,varargin,mfilename);


switch lower(InPar.Material)
    case 'sio2'
        L = [0.21:0.01:6.7]';
        n = sqrt(1 + 0.6961663.*L.^2./(L.^2 - 0.0684043.^2) + ...
                0.4079426.*L.^2./(L.^2 - 0.1162414.^2) + ...
                0.8974794.*L.^2./(L.^2 - 9.896161.^2));
        L         = L.*1e4;
        WaveRange = [210, 67000];  % [Ang]
        T         = 20;  % [C]
        t         = [];
        Reference = 'https://refractiveindex.info/?shelf=glass&book=fused_silica&page=Malitson';
    case 'si02_suprasil_2a'
        T = 20;
        P = 0;  % atmosphere
       n=[
           
       
       ];
        L = n(:,1);
        n = n(:,2);
    
        

         t=[1400            0
         1450            0
         1500            0
         1550            0
         1600     0.000239
         1650       0.0927
         1700        0.687
         1750        0.886
         1800         0.94
         1850        0.968
         1900        0.985
         1950         0.99
         2000        0.993
         2050        0.996
         2100        0.998
         2150        0.999
         2200        0.999
         2250        0.999
         2300        0.999
         2350        0.999
         2400            1
         2450            1
         2500            1
         2550            1
         2600            1
         2650            1
         2700            1
         2750            1
         2800            1
         2850            1
         2900            1
         2950            1
         3000            1
         4000            1
         5000            1
         6000            1
         7000            1
         8000            1
         9000            1
        10000            1
        11000            1
        12000            1
        13000        0.999
        13800        0.902
        14000        0.951
        15000            1
        16000            1
        17000            1
        18000        0.999
        19000        0.996
        20000        0.995
        20300        0.992
        20500        0.988
        20800        0.986
        21000        0.986
        21300        0.981
        21500        0.964
        21800        0.933
        22000        0.765
        22100        0.681
        22300        0.723
        22500        0.767
        22600        0.779
        22800        0.844
        23000        0.908
        23300         0.94
        23500        0.953
        23800        0.955
        24000        0.947
        24300        0.927
        24500        0.903
        24800         0.88
        25000        0.842
        25300        0.786
        25500        0.717
        25800        0.655
        26000        0.605
        26300        0.556
        26500        0.458
        26800         0.18
        27000     1.05e-05
        27200        1e-08
        27300        1e-08
        27500      2.9e-07
        27800     3.41e-05
        28000      0.00171
        28300       0.0321
        28500        0.162
        28800        0.345
        29000        0.494
        29300        0.599
        29500         0.67
        29800        0.718
        30000        0.751
        30300        0.776
        30500        0.794
        30800        0.808
        31000        0.814
        31300        0.819
        50000            0];

        
    otherwise
        error('Unknown Material option');
end

if (InPar.T~=T)
    error('Request for illigal temperature');
end
