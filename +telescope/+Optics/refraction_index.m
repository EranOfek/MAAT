function [L,n,t]=refraction_index(varargin)
% Return the refraction index as a function of wavelength
% Package: telescope.Optics
% Description: Return the refraction index as a function of wavelength
%              for various materials.
% Input  : - 
%          * Arbitrary number of pairs of arguments: ...,keyword,value,...
%            where keyword are one of the followings:
%            'T' - Temperature [C]. Default is 20.
%            'Material' - Options are:
%                         'SiO2' (fused silica) default.
% Output : - Wavelength [Ang].
%          - Refraction index
%          - [Wave[Ang], Transmission per 1cm thickness]
% License: GNU general public license version 3
%     By : Eran O. Ofek                    Oct 2019
%    URL : http://weizmann.ac.il/home/eofek/matlab/
% Example: [L,n,t]=telescope.Optics.refraction_index('Material','SiO2')
% Reliable: 
%--------------------------------------------------------------------------



DefV.T                    = 20;
DefV.Material             = 'si02_suprasil_2a';  % 'SiO2';
InPar = InArg.populate_keyval(DefV,varargin,mfilename);


switch lower(InPar.Material)
    case 'sio2'
        L = [0.21:0.01:6.7]';
        n = sqrt(1 + 0.6961663.*L.^2./(L.^2 - 0.0684043.^2) + ...
                0.4079426.*L.^2./(L.^2 - 0.1162414.^2) + ...
                0.8974794.*L.^2./(L.^2 - 9.896161.^2));
        L         = L.*1e4;
        WaveRange = [210, 67000];  % [Ang]
        T         = 20;  % [C]
        t         = [];
        Reference = 'https://refractiveindex.info/?shelf=glass&book=fused_silica&page=Malitson';
    case 'si02_suprasil_2a'
        T = 20;
        P = 1;  % atmosphere
       n=[1862       1.5726
       1963.4       1.5558
       2064.8       1.5424
       2166.1       1.5317
       2267.5       1.5228
       2368.9       1.5154
       2470.3       1.5092
       2571.7       1.5038
         2673       1.4992
       2774.4       1.4951
       2875.8       1.4916
       2977.2       1.4885
       3078.6       1.4857
       3179.9       1.4832
       3281.3        1.481
       3382.7        1.479
       3484.1       1.4772
       3585.5       1.4755
       3686.8        1.474
       3788.2       1.4727
       3889.6       1.4714
         3991       1.4702
       4092.4       1.4692
       4193.7       1.4682
       4295.1       1.4673
       4396.5       1.4664
       4497.9       1.4656
       4599.3       1.4649
       4700.6       1.4642
         4802       1.4635
       4903.4       1.4629
       5004.8       1.4623
       5106.2       1.4618
       5207.5       1.4613
       5308.9       1.4608
       5410.3       1.4603
       5511.7       1.4599
       5613.1       1.4595
       5714.4       1.4591
       5815.8       1.4587
       5917.2       1.4583
       6018.6        1.458
         6120       1.4577
       6221.3       1.4573
       6322.7        1.457
       6424.1       1.4568
       6525.5       1.4565
       6626.9       1.4562
       6728.2        1.456
       6829.6       1.4557
         6931       1.4555
       7032.4       1.4552
       7133.8        1.455
       7235.1       1.4548
       7336.5       1.4546
       7437.9       1.4544
       7539.3       1.4542
       7640.7        1.454
         7742       1.4538
       7843.4       1.4536
       7944.8       1.4534
       8046.2       1.4532
       8147.6       1.4531
       8248.9       1.4529
       8350.3       1.4527
       8451.7       1.4526
       8553.1       1.4524
       8654.5       1.4523
       8755.8       1.4521
       8857.2        1.452
       8958.6       1.4518
         9060       1.4517
       9161.4       1.4515
       9262.7       1.4514
       9364.1       1.4513
       9465.5       1.4511
       9566.9        1.451
       9668.3       1.4509
       9769.6       1.4507
         9871       1.4506
       9972.4       1.4505
        10074       1.4503
        10175       1.4502
        10277       1.4501
        10378         1.45
        10479       1.4498
        10581       1.4497
        10682       1.4496
        10783       1.4495
        10885       1.4493
        10986       1.4492
        11088       1.4491
        11189        1.449
        11290       1.4489
        11392       1.4488
        11493       1.4486
        11594       1.4485
        11696       1.4484
        11797       1.4483
        11899       1.4482
        12000       1.4481];
        L = n(:,1);
        n = n(:,2);
    
        

         t=[1400            0
         1450            0
         1500            0
         1550            0
         1600     0.000239
         1650       0.0927
         1700        0.687
         1750        0.886
         1800         0.94
         1850        0.968
         1900        0.985
         1950         0.99
         2000        0.993
         2050        0.996
         2100        0.998
         2150        0.999
         2200        0.999
         2250        0.999
         2300        0.999
         2350        0.999
         2400            1
         2450            1
         2500            1
         2550            1
         2600            1
         2650            1
         2700            1
         2750            1
         2800            1
         2850            1
         2900            1
         2950            1
         3000            1
         4000            1
         5000            1
         6000            1
         7000            1
         8000            1
         9000            1
        10000            1
        11000            1
        12000            1
        13000        0.999
        13800        0.902
        14000        0.951
        15000            1
        16000            1
        17000            1
        18000        0.999
        19000        0.996
        20000        0.995
        20300        0.992
        20500        0.988
        20800        0.986
        21000        0.986
        21300        0.981
        21500        0.964
        21800        0.933
        22000        0.765
        22100        0.681
        22300        0.723
        22500        0.767
        22600        0.779
        22800        0.844
        23000        0.908
        23300         0.94
        23500        0.953
        23800        0.955
        24000        0.947
        24300        0.927
        24500        0.903
        24800         0.88
        25000        0.842
        25300        0.786
        25500        0.717
        25800        0.655
        26000        0.605
        26300        0.556
        26500        0.458
        26800         0.18
        27000     1.05e-05
        27200        1e-08
        27300        1e-08
        27500      2.9e-07
        27800     3.41e-05
        28000      0.00171
        28300       0.0321
        28500        0.162
        28800        0.345
        29000        0.494
        29300        0.599
        29500         0.67
        29800        0.718
        30000        0.751
        30300        0.776
        30500        0.794
        30800        0.808
        31000        0.814
        31300        0.819
        50000            0];

        
    otherwise
        error('Unknown Material option');
end

if (InPar.T~=T)
    error('Request for illigal temperature');
end
