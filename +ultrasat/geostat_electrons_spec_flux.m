function [Out,ColCell]=geostat_electrons_spec_flux(varargin)
% Return spectral model for electron flux in geostationary orbit
% Package: ultrasat
% Description: Return spectral model for electron flux in geostationary
%              orbit.
% Input  :  * Arbitrary number of pairs of arguments: ...,keyword,value,...
%            where keyword are one of the followings:
%            'Source' - Default is 'AE9' model.
%            'OutType' - 'AstCat' | 'mat'. Default is 'mat'.
% Output : - Matrix or AstCat object containin spectra.
%            [counts(>E)/cm^2/s]
%          - ColCell
% License: GNU general public license version 3
%     By : Yossi Shvartzvald               Oct 2019
%    URL : http://weizmann.ac.il/home/eofek/matlab/
% Example:  [Out,ColCell]=ultrasat.geostat_electrons_spec_flux
%           [Out,ColCell]=ultrasat.geostat_electrons_spec_flux('OutType','astcat')
% Reliable: 2
%--------------------------------------------------------------------------



DefV.Source               = 'AE9';
DefV.OutType              = 'mat';   % 'AstCat' | 'mat'
InPar = InArg.populate_keyval(DefV,varargin,mfilename);


% units: counts(>E)/cm^2/s/(?   2\pi)

% daily
% Energy, daily_min mean_flux, daily_max mean_flux, daily_min 95%_flux, daily_max 95%_flux
vec=[0.04,63619019.6,61598061.5,219133005,209374930
0.07,36872356.9,36604332.6,121419597,119071840
0.1,23629478.6,24117441.4,75420703.3,76234260.4
0.25,6777807.92,7653097.8,21683725.7,24401822.4
0.5,1505849.67,1987502.64,5285939.47,6961335.26
0.75,532336.857,785319.25,2060170.96,3014375.25
1,256518.175,401961.156,1043794.38,1618766.73
1.5,77102.0547,130440.563,324862.269,544886.193
2,22695.0465,40323.4414,97545.6771,172236.871
2.5,7408.36548,13171.9014,32144.5391,56945.9078
3,2902.45382,4869.66977,12657.8754,21224.3154
3.5,1298.75613,2032.75609,5661.91617,8881.94978
4,648.157196,957.567543,2833.55844,4193.47025
4.5,355.238406,513.454146,1572.8338,2274.06138
5,219.826615,318.476592,988.712553,1433.74367
5.5,150.173834,218.868829,683.61939,998.874262
6,107.712056,157.225558,493.910694,723.398852
6.5,77.8067567,113.637181,358.767662,525.475644
7,57.4414259,84.0157197,265.858268,389.596614
8.5,21.5238149,31.6371704,100.141456,147.135716];
Fmat1=reshape(vec,[20,5]);

% daily max
% Energy, mean_flux, 50%_flux, 75%_flux, 95%_flux
vec=[0.04,61598061.5,35728619.8,82167128.4,209374930
0.07,36604332.6,22752921.9,49675314.8,119071840
0.1,24117441.4,15615086.5,33024741.1,76234260.4
0.25,7653097.8,4890918.78,10414799.6,24401822.4
0.5,1987502.64,1091815,2599014.31,6961335.26
0.75,785319.25,354441.093,970066.244,3014375.25
1,401961.156,158626.819,475113.598,1618766.73
1.5,130440.563,45347.7461,146957.507,544886.193
2,40323.4414,12783.5097,43765.0585,172236.871
2.5,13171.9014,3942.62118,13947.1046,56945.9078
3,4869.66977,1395.76484,5055.76672,21224.3154
3.5,2032.75609,572.229433,2089.12917,8881.94978
4,957.567543,263.889122,970.814129,4193.47025
4.5,513.454146,130.556961,499.560374,2274.06138
5,318.476592,71.2148678,291.441096,1433.74367
5.5,218.868829,42.8504716,188.206425,998.874262
6,157.225558,27.661211,128.388022,723.398852
6.5,113.637181,18.2519175,88.693106,525.475644
7,84.0157197,12.5727802,63.283367,389.596614
8.5,31.6371704,4.11078406,22.1665976,147.135716];
Fmat2=reshape(vec,[20,5]);

% daily min
% Energy, mean_flux, 50%_flux, 75%_flux, 95%_flux
vec=[0.04,63619019.6,36076316.5,84378698,219133005
0.07,36872356.9,22505752.7,49850150.8,121419597
0.1,23629478.6,15098752.9,32292885.2,75420703.3
0.25,6777807.92,4312831.41,9226564.31,21683725.7
0.5,1505849.67,824050.883,1968346.63,5285939.47
0.75,532336.857,235221.892,652987.839,2060170.96
1,256518.175,97922.906,299592.627,1043794.38
1.5,77102.0547,25912.6128,85714.0753,324862.269
2,22695.0465,6993.83398,24345.3269,97545.6771
2.5,7408.36548,2178.20925,7785.44585,32144.5391
3,2902.45382,829.45825,3009.48586,12657.8754
3.5,1298.75613,370.461383,1342.67285,5661.91617
4,648.157196,181.007089,661.824066,2833.55844
4.5,355.238406,91.3309337,348.523534,1572.8338
5,219.826615,50.3048578,204.295304,988.712553
5.5,150.173834,30.8234226,132.670368,683.61939
6,107.712056,20.3254414,91.3718367,493.910694
6.5,77.8067567,13.5646922,63.4974925,358.767662
7,57.4414259,9.37080518,45.3675733,265.858268
8.5,21.5238149,3.0546999,15.8521726,100.141456];
Fmat3=reshape(vec,[20,5]);

Tmp = [Fmat1(:,1:end), Fmat2(:,3:4), Fmat3(:,3:4)];
ColCell  = {'Energy','DailyMin_MeanFlux','DailyMax_MeanFlux','DailyMin_95flux','DailyMax_95flux','DailyMax_50flux','DailyMax_75flux','DailyMin_50flux','DailyMin_75flux'};
ColUnits = {'MeV','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s','counts(>E)/cm^2/s'};

switch lower(InPar.OutType)
    case 'mat'
        Out = Tmp;
    case 'astcat'
        Out = AstCat;
        Out.Cat = Tmp;
        Out.ColCell  = ColCell;
        Out.ColUnits = ColUnits;
        Out = colcell2col(Out);
        Out.Source = InPar.Source;
    otherwise
        error('Unknown OutType option');
end