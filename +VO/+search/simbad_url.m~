function [URL]=simbad_url(RA,Dec,varargin)
% Generate a SIMBAD URL for coordinates
% Package: VO.search
% Description: Generate a SIMBAD URL for coordinates
% Input  : - J2000 RA [rad]. See celestial.coo.convertdms for other options.
%          - J2000 Dec [rad]. See celestial.coo.convertdms for other options.
%          * Arbitrary number of pairs of arguments: ...,keyword,value,...
%            where keyword are one of the followings:
% Output : - 
% License: GNU general public license version 3
%     By : Eran O. Ofek                    Aug 2019
%    URL : http://weizmann.ac.il/home/eofek/matlab/
% Example: 
% Reliable: 
%--------------------------------------------------------------------------



DefV.CooFrame             = 'FK5';
DefV.CooEpoch             = 2000;
DefV.CooEquinox           = 2000;
DefV.SearchRadius         = 2;
DefV.SearchRadiusUnits    = 'arcmin';
InPar = InArg.populate_keyval(DefV,varargin,mfilename);

%http://simbad.u-strasbg.fr/simbad/sim-coo?Coord=01%3A47%3A02.707+%2B59%3A36%3A22.57&CooFrame=FK5&CooEpoch=2000&CooEqui=2000&CooDefinedFrames=none&Radius=2&Radius.unit=arcmin&submit=submit+query&CoordList=
%http://simbad.u-strasbg.fr/simbad/sim-coo?Coord=145+%2B12&CooFrame=FK5&CooEpoch=2000&CooEqui=2000&CooDefinedFrames=none&Radius=2&Radius.unit=arcmin&submit=submit+query&CoordList=

RA  = celestial.coo.convertdms(RA,'gH','r');
Dec = celestial.coo.convertdms(Dec,'gD','R');

Ncoo = numel(RA);

for Icoo=1:1:Ncoo
    URL{sprintf('http://simbad.u-strasbg.fr/simbad/sim-coo?Coord=%f+%f&CooFrame=%s&CooEpoch=%d&CooEqui=%d&CooDefinedFrames=none&Radius=%f&Radius.unit=%s&submit=submit+query&CoordList=',...
    RA