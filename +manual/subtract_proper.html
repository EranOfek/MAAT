<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>The SIM/subtract_proper method</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 15px; margin-right: 10px;  }
.S4 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { min-height: 0px; font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S9 { line-height: 15.5926675796509px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S14 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S15 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S17 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S18 { margin-left: 3px; margin-top: 4px; margin-bottom: 10px; margin-right: 3px;  }
.S19 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S20 { font-family: Helvetica, Arial, sans-serif; margin-left: 0px; margin-top: 10px; margin-bottom: 20px; margin-right: 0px;  }
.S21 { text-align: left; line-height: 21px; white-space: pre-wrap; white-space: pre-wrap; margin-left: 56px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S22 { font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {margin-top: 1px; margin-bottom: 1px;}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 4px; margin-bottom: 4px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {margin-left: 5px;}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: hidden;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veVariableValueSummary {display: inline-block;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 2px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement {min-height: 18px; box-sizing: border-box; font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.embeddedOutputsMatrixElement .matrixElement{position: relative;}
.matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.embeddedOutputsMatrixElement.inlineElement .veVariableName {padding-top: 0;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer {white-space: nowrap; padding-top: 10px; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.matrixElement { max-height: none !important; }
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-alertLine .alertPlugin-warningElement,.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.diagnosticMessage-wrapper {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">The SIM/subtract_proper method</span></h1><h1 class = "S3"><span class = "S2">in the Astronomy &amp; Astrophysics package for MATLAB</span></h1><h2 class = "S4"><span class = "S2">Description:</span></h2><p class = "S5"><span class = "S2">The </span><span class = "S6">SIM/subtract_proper</span><span class = "S2"> method is an image subtraction function based on the </span><a href = 'http://adsabs.harvard.edu/abs/2016ApJ...830...27Z'><span class = "S0">Zackay, Ofek &amp; Gal-Yam (2016)</span></a><span class = "S2"> algorithm (hereafter ZOGY). The function works with </span><a href = 'https://webhome.weizmann.ac.il/home/eofek/matlab/doc/SIM.html'><span class = "S0">SIM objects</span></a><span class = "S2">, and can perform most of the required pre-processing, including source extraction, flux matching and registration. The function can be used for transient detection and flux measurments in the difference image. </span></p><h2 class = "S4"><span class = "S2">Credit</span></h2><p class = "S5"><span class = "S2">If you are using this code or products in your scientific publication please give a reference to </span><a href = 'http://adsabs.harvard.edu/abs/2014ascl.soft07005O'><span class = "S0">Ofek (2014; ascl.soft 07005)</span></a><span class = "S2"> and  </span><a href = 'http://adsabs.harvard.edu/abs/2016ApJ...830...27Z'><span class = "S0">Zackay, Ofek &amp; Gal-Yam (2016)</span></a><span class = "S2">.</span></p><h2 class = "S4"><span class = "S2">License</span></h2><p class = "S5"><span class = "S2">Unless specified otherwise this code and products are released under the GNU general public license version 3.</span></p><h2 class = "S4"><span class = "S2">Installation</span></h2><p class = "S5"><span class = "S2">See</span><a href = 'http://webhome.weizmann.ac.il/home/eofek/matlab/doc/install.html'><span class = "S0"> http://weizmann.ac.il/home/eofek/matlab/doc/install.html </span></a><span class = "S2">for installation instruction and additional documentation.</span></p><h2 class = "S4"><span class = "S2">Introduction to ZOGY</span></h2><p class = "S5"><span class = "S2">Transient detection and flux measurement via image subtraction stand at the base of time domain astronomy. Due to the varying seeing conditions, the image subtraction process is non-trivial, and previous solutions suffer from a variety of problems. In </span><a href = 'http://adsabs.harvard.edu/abs/2016ApJ...830...27Z'><span class = "S0">Zackay, Ofek &amp; Gal-Yam (2016)</span></a><span class = "S2">, starting from basic statistical principles, we develop the optimal statistic for transient detection, flux measurement, and any image-difference hypothesis testing. We derive a closed-form statistic that: (1) is mathematically proven to be the optimal transient detection statistic in the limit of background-dominated noise, (2) is numerically stable, (3) for accurately registered, adequately sampled images, does not leave subtraction or deconvolution artifacts, (4) allows automatic transient detection to the theoretical sensitivity limit by providing credible detection significance, (5) has uncorrelated white noise, (6) is a sufficient statistic for any further statistical test on the difference image, and, in particular, allows us to distinguish particle hits and other image artifacts from real transients, (7) is symmetric to the exchange of the new and reference images, (8) is at least an order of magnitude faster to compute than some popular methods, and (9) is straightforward to implement. Furthermore, we present extensions of this method that make it resilient to registration errors, color-refraction errors, and any noise source that can be modeled. In addition, we show that the optimal way to prepare a reference image is the proper image coaddition presented in </span><a href = 'http://adsabs.harvard.edu/abs/2015arXiv151206879Z'><span class = "S0">Zackay &amp; Ofek (2016)</span></a><span class = "S2">. </span></p><h2 class = "S4"><span class = "S2">Older version</span></h2><p class = "S5"><span class = "S2">An older version of the </span><span class = "S6">SIM/subtract_proper</span><span class = "S2"> method is available in </span><span class = "S6">AstroIm.imsub_fft</span><span class = "S2">. However, this version is not supported.</span></p><h2 class = "S4"><span class = "S2">General notes and tips about image subtraction</span></h2><p class = "S5"><span class = "S2"></span></p><p class = "S5"><span class = "S2"></span></p><h1 class = "S3"><span class = "S2">Examples</span></h1><p class = "S5"><span class = "S2">The</span><span class = "S6"> SIM/subtract_proper</span><span class = "S2"> can subtract two registered images. The first step is to read images into SIM objects:</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10">S1 = FITS.read2sim(</span><span class = "S11">'PTF_20141122*100037_c02.fits'</span><span class = "S12">);</span></p></div></div><p class = "S13"><span class = "S2">In this specific example, S1 now contain two images. Next we would like to extract sources, estimate the PSF.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S12">S1 = gain_correct(S1);</span></p></div><div class = 'inlineWrapper outputs'><p class = "S9 lineNode"><span class = "S12">S1 = mextractor(S1);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="BBEFD6CF" data-testid="output_0" data-width="1176" style="width: 1206px;"><div class="textElement">&nbsp;&nbsp;Set gain to 1<br>mextractor first pass - Constructing optimal PSF<br>&nbsp;&nbsp;Set gain to 1<br>&nbsp;&nbsp;No filter found - Use DefFilter<br>&nbsp;&nbsp;Estimate images background and std<br> <br>Exiting: Maximum number of iterations has been exceeded<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - increase MaxIter option.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Current function value: 1254819.656688 </div></div><div class="inlineElement embeddedOutputsWarningElement" uid="4D705D0D" data-testid="output_1" data-width="1176" style="width: 1206px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: Best fit mode is out of range - set mode to max value and std to rstd</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement embeddedOutputsTextElement" uid="27350F9A" data-testid="output_2" data-width="1176" style="width: 1206px;"><div class="textElement"> <br>Exiting: Maximum number of iterations has been exceeded<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - increase MaxIter option.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Current function value: 1210799.391164 </div></div><div class="inlineElement embeddedOutputsWarningElement" uid="1A99A98F" data-testid="output_3" data-width="1176" style="width: 1206px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: Best fit mode is out of range - set mode to max value and std to rstd</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="1E89731E" data-testid="output_4" data-width="1176" style="width: 1206px; max-height: 420px;"><div class="textElement">&nbsp;&nbsp;Subtract background<br>mextractor image 1 out of 2<br>&nbsp;&nbsp;Filter image number 1 - use 1 filters<br>&nbsp;&nbsp;&nbsp;&nbsp;Threshold image and locate local maxima<br>&nbsp;&nbsp;&nbsp;&nbsp;Extracting 2884 sources<br>&nbsp;&nbsp;Calculate 1st and 2nd moments<br>mextractor image 2 out of 2<br>&nbsp;&nbsp;Filter image number 2 - use 1 filters<br>&nbsp;&nbsp;&nbsp;&nbsp;Threshold image and locate local maxima<br>&nbsp;&nbsp;&nbsp;&nbsp;Extracting 2869 sources<br>&nbsp;&nbsp;Calculate 1st and 2nd moments<br>mextractor second pass - Source detection and measurments<br>&nbsp;&nbsp;Subtract background<br>mextractor image 1 out of 2<br>&nbsp;&nbsp;Filter image number 1 - use 2 filters<br>&nbsp;&nbsp;&nbsp;&nbsp;Threshold image and locate local maxima<br>&nbsp;&nbsp;&nbsp;&nbsp;Extracting 6723 sources<br>&nbsp;&nbsp;Calculate 1st and 2nd moments<br>&nbsp;&nbsp;&nbsp;&nbsp;Calculate PSF photometry<br>&nbsp;&nbsp;&nbsp;&nbsp;Calculate IL aperture photometry (using aper_phot)<br>41 CR flagged in image 1<br>mextractor image 2 out of 2<br>&nbsp;&nbsp;Filter image number 2 - use 2 filters<br>&nbsp;&nbsp;&nbsp;&nbsp;Threshold image and locate local maxima<br>&nbsp;&nbsp;&nbsp;&nbsp;Extracting 6554 sources<br>&nbsp;&nbsp;Calculate 1st and 2nd moments<br>&nbsp;&nbsp;&nbsp;&nbsp;Calculate PSF photometry<br>&nbsp;&nbsp;&nbsp;&nbsp;Calculate IL aperture photometry (using aper_phot)<br>37 CR flagged in image 1</div></div></div></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S5"><span class = "S2">S1 now contains, for each image, its background image, noise image, source catalog and PSF. For example, you can plot the PSF of the first image:</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S9 lineNode"><span class = "S12">surface(S1(1).PSF)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsWarningElement" uid="45F5C7B1" data-testid="output_5" data-width="1176" style="width: 1206px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: MATLAB has disabled some advanced graphics rendering features by switching to software OpenGL. For more information, click here.</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement embeddedOutputsFigure" uid="6669C318" data-testid="output_6" style="width: 1206px;"><div class="figureElement"><img class="figureImage" draggable="false" src="data:image/png;base64,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pSstd91xV/011/YR3/R726f3Pb1wAU4uRm7/fTHapeF777m3OnTgUGXfs2PH/if21+HFXpnNu6yMjn/X0d74aBusHenvddkn49J99hHKSb3g+e/aTeoyfXs5usJyN01NY7uabevbXqQkRqfP5/98HmZb9qJpRqf/vVxto3FLgJkBjb3BzD4VYwvPDrvyYpvtNED8u7uR2d+RmtQ0abvpG5vqvzeFlt203LNrz1Uuk4aT57Zfw8HzYm2XoyssL9YzredFuhq7bR+agNnFGi9X22jcEmBmBBhbfPa7RftCu386/U+V3U4LkvPihTVPI/s1kX2r8dmXz1b/+u6/ouscBufpuNzH4Lkft216w7Je00mdYXYYfaNwS4D5kjaPyUXJ7WEWJbqiKwzAAAyUwwABhgADAzAAAzAAAzAwOgZG12HSdTnpmrlmrmEABmAABmYxQIAhdcMADMAADMAADIyOgdF1eFYS435SOgzAAAzAAAyUwwABhtQNAzAAAzAAAzAwOgZG12HSdTnpmrlmrmEABmAABmYxQIAhdcMADMAADMAADIyOgdF1eFYS435SOgzAAAzAAAyUwwABhtQNAzAAAzAAAzAwOgZG12HSdTnpmrlmrmEABmAABmYxQIAhdcMADMAADMAADIyOgdF1eFYS435SOgzAAAzAAAyUwwABhtQNAzAAAzAAAzAwOgZG12HSdTnpmrlmrmEABmAABmYxQIAhdcMADMAADMAADIyOgdF1eFYS435SOgzAAAzAAAyUwwABhtQNAzAAAzAAAzAwOgZG12HSdTnpmrlmrmEABmAABmYxQIAhdcMADMAADMAADIyOgdF1eFYS435SOgzAAAzAAAyUw8D/BR0t9EEo86RfAAAAAElFTkSuQmCC" style="width: 560px;"></div></div></div></div><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S12"></span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S5"><span class = "S2">Next we can regsiter the images</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S9 lineNode"><span class = "S12">[AS1,FitTran] = align(S1,S1(2));</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsVariableStringElement" uid="42474599" data-testid="output_7" data-width="1176" style="width: 1206px;"><div class="textElement"><div>Iep = </div><div>&nbsp;&nbsp;&nbsp;&nbsp; 1<br><br></div></div></div><div class="inlineElement embeddedOutputsVariableStringElement" uid="E325BB5F" data-testid="output_8" data-width="1176" style="width: 1206px;"><div class="textElement"><div>Iep = </div><div>&nbsp;&nbsp;&nbsp;&nbsp; 2<br><br></div></div></div><div class="inlineElement embeddedOutputsVariableStringElement" uid="1E2C2AD9" data-testid="output_9" data-width="1176" style="width: 1206px;"><div class="textElement"><div>Iep = </div><div>&nbsp;&nbsp;&nbsp;&nbsp; 3<br><br></div></div></div><div class="inlineElement embeddedOutputsTextElement" uid="109F6E76" data-testid="output_10" data-width="1176" style="width: 1206px;"><div class="textElement">SIM/transform: WCS was not corrected<br>SIM/transform: WCS was not corrected</div></div></div></div></div><p class = "S13"><span class = "S2">Note that by default the </span><span class = "S6">SIM/align</span><span class = "S2"> method uses the 'AlignMethod' equal 'wcsCoo'. In some cases you may like to use a different option (see </span><span class = "S6">help SIM/align</span><span class = "S2"> for more options).</span></p><p class = "S5"><span class = "S2">To verify that the images are registered you can display them using ds9 and blink them</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S9 lineNode"><span class = "S10">ds9(AS1);  </span><span class = "S16">% read the two images into ds9</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="AC0C1131" data-testid="output_11" data-width="1176" style="width: 1206px;"><div class="textElement">FitTran<br>eran&nbsp;&nbsp;&nbsp;&nbsp; 40090&nbsp;&nbsp;1.0&nbsp;&nbsp;0.0 147340 45936 pts/38&nbsp;&nbsp; S&nbsp;&nbsp;&nbsp;&nbsp;15:26&nbsp;&nbsp; 0:05 ds9<br>ds9 is already open</div></div></div></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S5"><span class = "S2">Note that by default (unless specified otherwise), </span><span class = "S6">SIM/align</span><span class = "S2"> will set the value of non-overlapping pixels to NaN, and in this case the image subtraction will fail. In order to mitigate this you can replace this NaN values by the mean background level (e.g., using </span><span class = "S6">SIM/replace_with_noise</span><span class = "S2">), or trim the images.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S12">AS1=trim_image(AS1,[11 1000 11 1000]);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S5"><span class = "S2">Next, we can estimate the relative zero point (or flux matching) between the two images:</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10"> [ZP,Fzp,ResZP]=zp_estimate(AS1,2,</span><span class = "S11">'SkipWCS'</span><span class = "S10">,true,</span><span class = "S17">...</span></p></div><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10">                         </span><span class = "S11">'Columns'</span><span class = "S10">,{</span><span class = "S11">'XWIN_IMAGE'</span><span class = "S10">,</span><span class = "S11">'YWIN_IMAGE'</span><span class = "S10">,</span><span class = "S11">'MAG_PSF'</span><span class = "S10">,</span><span class = "S11">'MAGERR_PSF'</span><span class = "S10">},</span><span class = "S17">...</span></p></div><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10">                                              </span><span class = "S11">'MagCol'</span><span class = "S10">,</span><span class = "S11">'MAG_PSF'</span><span class = "S10">,</span><span class = "S17">...</span></p></div><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10">                                              </span><span class = "S11">'MagErrCol'</span><span class = "S10">,</span><span class = "S11">'MAGERR_PSF'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S12">        </span></p></div></div><p class = "S13"><span class = "S2"> Finally, we can subtract the two images:</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S9 lineNode"><span class = "S10">[Summary,D,S,Scorr,SigmaF]=subtract_proper(AS1(1),AS1(2),</span><span class = "S17">...</span></p></div><div class = 'inlineWrapper outputs'><p class = "S9 lineNode"><span class = "S10">    </span><span class = "S11">'FluxMatch'</span><span class = "S10">,Fzp(1),</span><span class = "S11">'SigmaX'</span><span class = "S10">,FitTran(1).rrms,</span><span class = "S11">'SigmaY'</span><span class = "S12">,FitTran(1).rrms);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="117D02D7" data-testid="output_12" data-width="1176" style="width: 1206px;"><div class="textElement">&nbsp;&nbsp;Set gain to 1<br>&nbsp;&nbsp;Subtract background<br>&nbsp;&nbsp;Set gain to 1<br>&nbsp;&nbsp;Subtract background</div></div></div></div></div><p class = "S13"><span class = "S2">Note that </span><span class = "S6">SIM/subtract_proper</span><span class = "S2"> has many options including the ability to perform many of the pre-processing steps. However, for clarity we gave a step by step example. In this example, the 'FluxMatch' keyword value contains the flux matching between the two images, and the 'SigmaX' and 'SigmaY' contain the registration error in pixels.</span></p><p class = "S5"><span class = "S19">The output:</span></p><p class = "S5"><span class = "S6">Summary:</span><span class = "S2"> A structure array containing the following fields:</span></p><ul class = "S20"><li class = "S21"><span class = "S22">Beta</span><span class = "S0">: The flux matching parameter</span></li><li class = "S21"><span class = "S22">FD</span><span class = "S0">: The flux normalization for the D image (Equation 15 in ZOGY).</span></li><li class = "S21"><span class = "S22">F_S</span><span class = "S0">: The flux normalization for the S image (Equation 42 in ZOGY). The flux of the transients in units of the zero point of the reference image is given by dividing S at the position of the transient local maxima by F_S (i.e., Equation 41 in ZOGY).</span></li><li class = "S21"><span class = "S22">SigmaFlux</span><span class = "S0">: Flux error matrix for each pixel in the image (Equation 43 in ZOGY). This does not include source noise or astrometric noise.</span></li></ul><p class = "S5"><span class = "S6">D</span><span class = "S2">: A SIM object containing the proper subtraction image (Equation 13 in ZOGY). The PSF (Equation 14 in ZOGY) is stored in </span><span class = "S6">D.PSF</span><span class = "S2">. This is useful in order to look for cosmic rays in images.</span></p><p class = "S5"><span class = "S6">S</span><span class = "S2">: The transient detection statistics not corrected for source noise and astrometric noise (Equation 12 in ZOGY). This is useful in order to measure flux of transients.</span></p><p class = "S5"><span class = "S6">Scorr</span><span class = "S2">: The transient detection statistics corrected for source noise and astrometric noise (Equation 25 in ZOGY). This is useful in order to search for transients.</span></p><p class = "S5"><span class = "S6">SigmaF</span><span class = "S2">: like </span><span class = "S6">SigmaFlux</span><span class = "S2">.</span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% The SIM/subtract_proper method
%% in the Astronomy & Astrophysics package for MATLAB
%% Description:
% The |SIM/subtract_proper| method is an image subtraction function based on 
% the <http://adsabs.harvard.edu/abs/2016ApJ...830...27Z Zackay, Ofek & Gal-Yam 
% (2016)> algorithm (hereafter ZOGY). The function works with <https://webhome.weizmann.ac.il/home/eofek/matlab/doc/SIM.html 
% SIM objects>, and can perform most of the required pre-processing, including 
% source extraction, flux matching and registration. The function can be used 
% for transient detection and flux measurments in the difference image. 
%% Credit
% If you are using this code or products in your scientific publication please 
% give a reference to <http://adsabs.harvard.edu/abs/2014ascl.soft07005O Ofek 
% (2014; ascl.soft 07005)> and  <http://adsabs.harvard.edu/abs/2016ApJ...830...27Z 
% Zackay, Ofek & Gal-Yam (2016)>.
%% License
% Unless specified otherwise this code and products are released under the GNU 
% general public license version 3.
%% Installation
% See<http://webhome.weizmann.ac.il/home/eofek/matlab/doc/install.html  http://weizmann.ac.il/home/eofek/matlab/doc/install.html 
% >for installation instruction and additional documentation.
%% Introduction to ZOGY
% Transient detection and flux measurement via image subtraction stand at the 
% base of time domain astronomy. Due to the varying seeing conditions, the image 
% subtraction process is non-trivial, and previous solutions suffer from a variety 
% of problems. In <http://adsabs.harvard.edu/abs/2016ApJ...830...27Z Zackay, Ofek 
% & Gal-Yam (2016)>, starting from basic statistical principles, we develop the 
% optimal statistic for transient detection, flux measurement, and any image-difference 
% hypothesis testing. We derive a closed-form statistic that: (1) is mathematically 
% proven to be the optimal transient detection statistic in the limit of background-dominated 
% noise, (2) is numerically stable, (3) for accurately registered, adequately 
% sampled images, does not leave subtraction or deconvolution artifacts, (4) allows 
% automatic transient detection to the theoretical sensitivity limit by providing 
% credible detection significance, (5) has uncorrelated white noise, (6) is a 
% sufficient statistic for any further statistical test on the difference image, 
% and, in particular, allows us to distinguish particle hits and other image artifacts 
% from real transients, (7) is symmetric to the exchange of the new and reference 
% images, (8) is at least an order of magnitude faster to compute than some popular 
% methods, and (9) is straightforward to implement. Furthermore, we present extensions 
% of this method that make it resilient to registration errors, color-refraction 
% errors, and any noise source that can be modeled. In addition, we show that 
% the optimal way to prepare a reference image is the proper image coaddition 
% presented in <http://adsabs.harvard.edu/abs/2015arXiv151206879Z Zackay & Ofek 
% (2016)>. 
%% Older version
% An older version of the |SIM/subtract_proper| method is available in |AstroIm.imsub_fft|. 
% However, this version is not supported.
%% General notes and tips about image subtraction
% 
% 
% 
%% Examples
% The| SIM/subtract_proper| can subtract two registered images. The first step 
% is to read images into SIM objects:

S1 = FITS.read2sim('PTF_20141122*100037_c02.fits');
%% 
% In this specific example, S1 now contain two images. Next we would like 
% to extract sources, estimate the PSF.

S1 = gain_correct(S1);
S1 = mextractor(S1);
%% 
% S1 now contains, for each image, its background image, noise image, source 
% catalog and PSF. For example, you can plot the PSF of the first image:

surface(S1(1).PSF)

%% 
% Next we can regsiter the images

[AS1,FitTran] = align(S1,S1(2));
%% 
% Note that by default the |SIM/align| method uses the 'AlignMethod' equal 
% 'wcsCoo'. In some cases you may like to use a different option (see |help SIM/align| 
% for more options).
% 
% To verify that the images are registered you can display them using ds9 
% and blink them

ds9(AS1);  % read the two images into ds9
%% 
% Note that by default (unless specified otherwise), |SIM/align| will set 
% the value of non-overlapping pixels to NaN, and in this case the image subtraction 
% will fail. In order to mitigate this you can replace this NaN values by the 
% mean background level (e.g., using |SIM/replace_with_noise|), or trim the images.

AS1=trim_image(AS1,[11 1000 11 1000]);
%% 
% Next, we can estimate the relative zero point (or flux matching) between 
% the two images:

 [ZP,Fzp,ResZP]=zp_estimate(AS1,2,'SkipWCS',true,...
                         'Columns',{'XWIN_IMAGE','YWIN_IMAGE','MAG_PSF','MAGERR_PSF'},...
                                              'MagCol','MAG_PSF',...
                                              'MagErrCol','MAGERR_PSF');
        
%% 
%  Finally, we can subtract the two images:

[Summary,D,S,Scorr,SigmaF]=subtract_proper(AS1(1),AS1(2),...
    'FluxMatch',Fzp(1),'SigmaX',FitTran(1).rrms,'SigmaY',FitTran(1).rrms);
%% 
% Note that |SIM/subtract_proper| has many options including the ability 
% to perform many of the pre-processing steps. However, for clarity we gave a 
% step by step example. In this example, the 'FluxMatch' keyword value contains 
% the flux matching between the two images, and the 'SigmaX' and 'SigmaY' contain 
% the registration error in pixels.
% 
% *The output:*
% 
% |Summary:| A structure array containing the following fields:
% 
% * |Beta|: The flux matching parameter
% * |FD|: The flux normalization for the D image (Equation 15 in ZOGY).
% * |F_S|: The flux normalization for the S image (Equation 42 in ZOGY). The 
% flux of the transients in units of the zero point of the reference image is 
% given by dividing S at the position of the transient local maxima by F_S (i.e., 
% Equation 41 in ZOGY).
% * |SigmaFlux|: Flux error matrix for each pixel in the image (Equation 43 
% in ZOGY). This does not include source noise or astrometric noise.
% 
% |D|: A SIM object containing the proper subtraction image (Equation 13 
% in ZOGY). The PSF (Equation 14 in ZOGY) is stored in |D.PSF|. This is useful 
% in order to look for cosmic rays in images.
% 
% |S|: The transient detection statistics not corrected for source noise 
% and astrometric noise (Equation 12 in ZOGY). This is useful in order to measure 
% flux of transients.
% 
% |Scorr|: The transient detection statistics corrected for source noise 
% and astrometric noise (Equation 25 in ZOGY). This is useful in order to search 
% for transients.
% 
% |SigmaF|: like |SigmaFlux|.
##### SOURCE END #####
--></body></html>